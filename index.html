<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Dino Dash</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #f7f7f7;
      font-family: monospace;
      overflow: hidden;
      user-select: none;
      -webkit-user-select: none;
    }
    canvas {
      display: block;
      margin: 0 auto;
      image-rendering: pixelated;
      touch-action: none;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.85.0/dist/phaser.js"></script>
</head>
<body>

<script>
const config = {
  type: Phaser.AUTO,
  width: 800,
  height: 400,
  backgroundColor: "#f7f7f7",
  scale: {
    mode: Phaser.Scale.FIT,
    autoCenter: Phaser.Scale.CENTER_BOTH
  },
  physics: {
    default: "arcade",
    arcade: {
      gravity: { y: 1400 },
      debug: false
    }
  },
  scene: { preload, create, update }
};

let game = new Phaser.Game(config);

let dino, ground, obstacles;
let score = 0;
let highScore = 0;
let gameSpeed = 6;
let isGameOver = false;
let scoreText, hiText;
let spawnTimer = 0;
let spawnInterval = 1500;

function preload() {
  const g = this.add.graphics();
  
  // Dino sprite (simple T-Rex style)
  g.fillStyle(0x535353);
  g.fillRect(4, 0, 16, 20);    // body
  g.fillRect(0, 8, 8, 8);      // head
  g.fillRect(6, 20, 4, 12);    // leg1
  g.fillRect(14, 20, 4, 12);   // leg2
  g.fillRect(18, 4, 8, 8);     // tail
  g.generateTexture("dino", 28, 32);
  g.clear();

  // Small cactus
  g.fillStyle(0x2d8659);
  g.fillRect(4, 8, 8, 24);
  g.fillRect(0, 16, 4, 12);
  g.fillRect(12, 16, 4, 12);
  g.generateTexture("cactus1", 16, 32);
  g.clear();

  // Tall cactus
  g.fillRect(4, 0, 8, 32);
  g.fillRect(0, 8, 4, 16);
  g.fillRect(12, 8, 4, 16);
  g.generateTexture("cactus2", 16, 32);
  g.clear();

  // Bird
  g.fillStyle(0x535353);
  g.fillRect(4, 4, 12, 8);
  g.fillRect(0, 6, 8, 4);
  g.fillRect(12, 6, 8, 4);
  g.generateTexture("bird", 20, 16);
  g.destroy();
}

function create() {
  // Ground line
  ground = this.add.rectangle(0, 350, 1600, 2, 0x535353).setOrigin(0);
  this.physics.add.existing(ground, true);

  // Dino
  dino = this.physics.add.sprite(80, 318, "dino");
  dino.setCollideWorldBounds(true);
  dino.body.setSize(24, 28);
  dino.body.setOffset(2, 4);

  // Obstacles group
  obstacles = this.physics.add.group();

  // Collision
  this.physics.add.collider(dino, ground);
  this.physics.add.overlap(dino, obstacles, hitObstacle, null, this);

  // Score display
  scoreText = this.add.text(650, 20, "00000", {
    fontFamily: "monospace",
    fontSize: "20px",
    fill: "#535353"
  });

  hiText = this.add.text(550, 20, "HI 00000", {
    fontFamily: "monospace",
    fontSize: "20px",
    fill: "#535353"
  });

  // Input: tap/click anywhere or SPACE
  this.input.on("pointerdown", jump, this);
  this.input.keyboard.on("keydown-SPACE", jump, this);

  // Initial spawn
  spawnObstacle.call(this);
}

function update(time, delta) {
  if (isGameOver) return;

  // Increment score
  score += 1;
  scoreText.setText(String(score).padStart(5, "0"));

  // Speed increase over time
  gameSpeed = 6 + score * 0.001;

  // Move obstacles
  obstacles.children.iterate(obs => {
    if (!obs || !obs.active) return;
    obs.x -= gameSpeed;
    
    // Recycle off-screen
    if (obs.x < -50) {
      obs.destroy();
    }
  });

  // Spawn new obstacles with timer
  spawnTimer += delta;
  if (spawnTimer > spawnInterval) {
    spawnTimer = 0;
    spawnInterval = Phaser.Math.Between(1200, 2400) - score * 0.5;
    spawnInterval = Math.max(spawnInterval, 600);
    spawnObstacle.call(this);
  }

  // Keep dino from falling through ground
  if (dino.y > 318 && dino.body.velocity.y > 0) {
    dino.y = 318;
    dino.setVelocityY(0);
  }
}

function jump() {
  if (isGameOver) {
    restartGame.call(this);
    return;
  }

  // Only jump if on ground
  if (dino.y >= 318) {
    dino.setVelocityY(-600);
  }
}

function spawnObstacle() {
  const type = Phaser.Math.Between(1, 3);
  let obs;

  if (type === 1) {
    // Small cactus on ground
    obs = obstacles.create(850, 326, "cactus1");
    obs.body.setSize(14, 28);
  } else if (type === 2) {
    // Tall cactus on ground
    obs = obstacles.create(850, 318, "cactus2");
    obs.body.setSize(14, 30);
  } else {
    // Flying bird (mid-height)
    obs = obstacles.create(850, 270, "bird");
    obs.body.setSize(18, 14);
  }

  obs.setImmovable(true);
  obs.body.allowGravity = false;
}

function hitObstacle(dino, obstacle) {
  if (isGameOver) return;

  isGameOver = true;
  dino.setTint(0xff0000);
  
  // Update high score
  if (score > highScore) {
    highScore = score;
    hiText.setText("HI " + String(highScore).padStart(5, "0"));
  }

  // Show game over message
  this.add.text(300, 150, "GAME OVER", {
    fontFamily: "monospace",
    fontSize: "32px",
    fill: "#535353"
  });

  this.add.text(280, 200, "Tap to Restart", {
    fontFamily: "monospace",
    fontSize: "20px",
    fill: "#535353"
  });
}

function restartGame() {
  isGameOver = false;
  score = 0;
  gameSpeed = 6;
  spawnTimer = 0;
  spawnInterval = 1500;
  this.scene.restart();
}
</script>

</body>
</html>
